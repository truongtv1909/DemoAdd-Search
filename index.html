<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf8" />
        <title>HTML & Javascript</title>
    </head>
    <body>
        <h1>Todo - list</h1>
        <input type="text" id="new-item" placeholder="input dosomething" /> <button onclick="addTodo()">add</button>
        <ul id="todo-list-map">
        </ul>
        <h1>Function search by Phone, Name</h1>
        <input type="text" id="searchInput" placeholder="Search by phone number..." />
        <ul id="userList">
        
        </ul>
        <script type="text/javascript">
        var newTodo = document.getElementById("new-item");
        var userList = document.getElementById('userList');
        var searchInput = document.getElementById('searchInput');
        

        var users = [
            { 
            name: 'Thinh', 
            phone: '070123123'
            },
            {
            name: 'Luan',
            phone: '080456456'
            },
            {
            name: 'Huyen',
            phone: '090123123'
            },
            {
            name: 'Quynh',
            phone: '0985929796'
            },
            {
            name: 'Anh.Truong',
            phone: '0985929797'
            },
            {
            name: 'Ha',
            phone: '0962078386'
            }
        ];

            var keytodo="keytodo";
      
            var todoString = sessionStorage.getItem(keytodo);
            if(todoString){
                var todo = JSON.parse(todoString);
            }else{
                var todo = [];
            }
            
            
            function addTodo(){
                // get text from inbox
                
                var newText = newTodo.value;
               
                if(newText){
                    todo.push(newText);
                }
                
                render();
                
                sessionStorage.setItem(keytodo,JSON.stringify(todo));
                newTodo.value = '';
            }

            function deleteTodo(a){
                var removeLi = document.getElementById('li-map-'+a+'');
                var xxx = removeLi.value
                todo.splice(a,1);
                sessionStorage.setItem(keytodo,JSON.stringify(todo));
                render();
            }

            // list by map arr---------------------------------------------------------------------
            function render(){
                var contenL1 = document.getElementById('todo-list-map');
            var arrTodoHtml =todo.map(function(item,i){
                return '<li id ="li-map-'+i+'">' + item + '  ' + '<button onclick="deleteTodo('+i+')">Delete</button></li>';
            });
            var content = arrTodoHtml.join('');
            contenL1.innerHTML=content;
            }
            render(); 

        function renderSearch(us) { // render
            
        var content = us.map(function(us) {
         a = '<li>' + us.name + ' - ' + us.phone + '</li>';

        return a;
        });
        var contentrs=content.join('');
        if(contentrs){
        userList.innerHTML = contentrs;
        }else{
            userList.innerHTML = 'Empty';
        }
        }

        searchInput.addEventListener('keyup', function(event) { // search function
        var value = searchInput.value;
        var result = users.filter(function(us){
             var resPhone =  us.phone.includes(value);
             var resName = us.name.toLocaleLowerCase().includes(value.toLocaleLowerCase());
             if(resPhone){
                return resPhone;
             }if(resName){
                 return resName;
             }             
        });
        renderSearch(result);
        });

        renderSearch(users);          

        </script>
    </body>
</html>